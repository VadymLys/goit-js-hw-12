{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst container = document.querySelector(\"div\");\nconst searchInput = document.querySelector(\"input\");\nconst btnLoad = document.querySelector(\".btn-load\");\n\nconst showLoader = () => {\n    const loader = document.createElement('span');\n    loader.classList.add(\"loader\");\n    container.append(loader);\n}\n\nconst hideLoader = () => {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n        loader.remove();\n    }\n}\n\n\nconst showButton = () => {\n    btnLoad.style.display = \"block\";\n}\n\nconst hideButton = () => {\n    btnLoad.style.display = \"none\";\n}\n\n\nlet page = 1;\nlet per_page = 40;\nlet query = \"\";\nlet totalHits;\n\nform.addEventListener(\"submit\", async (evt) => {\n    page = 1;\n    showLoader();\n    gallery.innerHTML = \"\";\n    evt.preventDefault();\n    try {\n        query = searchInput.value;\n        const photos = await searchImages();\n        renderImages(photos);\n        form.reset();\n        hideLoader();\n        showButton();\n        if (photos.hits.length < 40) {\n            hideButton();\n        }\n        if (photos.hits.length === 0) {\n            hideButton();\n            iziToast.error({\n                message: \"Sorry, there are no images matching <br>your search query. Please try again!</br>\",\n                position: 'center',\n                transitionIn: \"fadeInLeft\",\n            });\n        }\n\n    } catch (err) {\n        iziToast.err({\n            title: 'Error',\n        });\n    }\n})\n\n\nbtnLoad.addEventListener(\"click\", async () => {\n    showLoader();\n    try {\n        page += 1;\n        const photos = await searchImages();\n        renderImages(photos);\n        hideLoader();\n\n        const { height: cardHeight } = document.querySelector('.gallery')\n            .firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        });\n        if (gallery.children.length >= totalHits || photos.hits.length < per_page) {\n            iziToast.warning({\n                message: 'We are sorry, but you have reached the end of search results.',\n                position: 'bottomCenter',\n                transitionIn: 'fadeInDown',\n            });\n            hideButton();\n        }\n    } catch (err) {\n        iziToast.err({\n            title: 'Error'\n        })\n        hideLoader();\n    }\n}) \n\nasync function searchImages() {\n    try {\n        const apiKey = '42291440-1a96f303b7bedbf570d96cd98';\n        const params = new URLSearchParams({\n            key: apiKey,\n            q: query,\n            image_type: \"photo\",\n            safesearch: true,\n            page: page,\n            per_page: per_page\n        })\n        const response = await axios.get(`https://pixabay.com/api/?${params}`);\n        totalHits = response.data.totalHits;\n\n        return response.data;\n    } catch (err) {\n        console.log(err);\n        throw WebTransportError;\n    }\n};\n\nfunction renderImages(data) {\n    const markup = data.hits.map(data => {\n        return `             <li class=\"gallery-item\"><a href=\"${data.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"></a>\n           <p><b>Likes: </b>${data.likes}</p>\n          <p><b>Views: </b>${data.views}</p>\n        <p><b>Comments: </b>${data.comments}</p>\n        <p><b>Downloads: </b>${data.downloads}</p>\n         </li>`;\n    }).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n    const lightbox = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionType: 'attr',\n        captionData: 'alt',\n        captionPosition: 'bottom',\n        fadeSpeed: 150,\n        captionSelector: 'img',\n        captionDelay: 250\n    });\n    lightbox.on('show.simplelightbox').refresh();\n    hideLoader();\n};\n\n\n        \n"],"names":["form","gallery","container","searchInput","btnLoad","showLoader","loader","hideLoader","showButton","hideButton","page","per_page","query","totalHits","evt","photos","searchImages","renderImages","iziToast","cardHeight","apiKey","params","response","axios","err","data","markup","SimpleLightbox"],"mappings":"+vBAOA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAY,SAAS,cAAc,KAAK,EACxCC,EAAc,SAAS,cAAc,OAAO,EAC5CC,EAAU,SAAS,cAAc,WAAW,EAE5CC,EAAa,IAAM,CACrB,MAAMC,EAAS,SAAS,cAAc,MAAM,EAC5CA,EAAO,UAAU,IAAI,QAAQ,EAC7BJ,EAAU,OAAOI,CAAM,CAC3B,EAEMC,EAAa,IAAM,CACrB,MAAMD,EAAS,SAAS,cAAc,SAAS,EAC3CA,GACAA,EAAO,OAAM,CAErB,EAGME,EAAa,IAAM,CACrBJ,EAAQ,MAAM,QAAU,OAC5B,EAEMK,EAAa,IAAM,CACrBL,EAAQ,MAAM,QAAU,MAC5B,EAGA,IAAIM,EAAO,EACPC,EAAW,GACXC,EAAQ,GACRC,EAEJb,EAAK,iBAAiB,SAAU,MAAOc,GAAQ,CAC3CJ,EAAO,EACPL,IACAJ,EAAQ,UAAY,GACpBa,EAAI,eAAc,EAClB,GAAI,CACAF,EAAQT,EAAY,MACpB,MAAMY,EAAS,MAAMC,IACrBC,EAAaF,CAAM,EACnBf,EAAK,MAAK,EACVO,IACAC,IACIO,EAAO,KAAK,OAAS,IACrBN,IAEAM,EAAO,KAAK,SAAW,IACvBN,IACAS,EAAS,MAAM,CACX,QAAS,oFACT,SAAU,SACV,aAAc,YAC9B,CAAa,EAGR,MAAa,CACVA,EAAS,IAAI,CACT,MAAO,OACnB,CAAS,CACJ,CACL,CAAC,EAGDd,EAAQ,iBAAiB,QAAS,SAAY,CAC1CC,IACA,GAAI,CACAK,GAAQ,EACR,MAAMK,EAAS,MAAMC,IACrBC,EAAaF,CAAM,EACnBR,IAEA,KAAM,CAAE,OAAQY,CAAU,EAAK,SAAS,cAAc,UAAU,EAC3D,kBAAkB,sBAAqB,EAC5C,OAAO,SAAS,CACZ,IAAKA,EAAa,EAClB,SAAU,QACtB,CAAS,GACGlB,EAAQ,SAAS,QAAUY,GAAaE,EAAO,KAAK,OAASJ,KAC7DO,EAAS,QAAQ,CACb,QAAS,gEACT,SAAU,eACV,aAAc,YAC9B,CAAa,EACDT,IAEP,MAAa,CACVS,EAAS,IAAI,CACT,MAAO,OACnB,CAAS,EACDX,GACH,CACL,CAAC,EAED,eAAeS,GAAe,CAC1B,GAAI,CACA,MAAMI,EAAS,qCACTC,EAAS,IAAI,gBAAgB,CAC/B,IAAKD,EACL,EAAGR,EACH,WAAY,QACZ,WAAY,GACZ,KAAMF,EACN,SAAUC,CACtB,CAAS,EACKW,EAAW,MAAMC,EAAM,IAAI,4BAA4BF,CAAM,EAAE,EACrE,OAAAR,EAAYS,EAAS,KAAK,UAEnBA,EAAS,IACnB,OAAQE,EAAK,CACV,cAAQ,IAAIA,CAAG,EACT,iBACT,CACL,CAEA,SAASP,EAAaQ,EAAM,CACxB,MAAMC,EAASD,EAAK,KAAK,IAAIA,GAClB,kDAAkDA,EAAK,aAAa;AAAA,0CACzCA,EAAK,YAAY,UAAUA,EAAK,IAAI;AAAA,8BAChDA,EAAK,KAAK;AAAA,6BACXA,EAAK,KAAK;AAAA,8BACTA,EAAK,QAAQ;AAAA,+BACZA,EAAK,SAAS;AAAA,eAExC,EAAE,KAAK,EAAE,EAEVxB,EAAQ,mBAAmB,YAAayB,CAAM,EAC7B,IAAIC,EAAe,aAAc,CAC9C,SAAU,GACV,YAAa,OACb,YAAa,MACb,gBAAiB,SACjB,UAAW,IACX,gBAAiB,MACjB,aAAc,GACtB,CAAK,EACQ,GAAG,qBAAqB,EAAE,QAAO,EAC1CpB,GACJ"}