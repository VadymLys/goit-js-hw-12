{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst container = document.querySelector(\"div\");\nconst searchInput = document.querySelector(\"input\");\nconst btnLoad = document.querySelector(\".btn-load\");\n\nfunction toggleLoader(showLoader) {\n    if (showLoader) {\n        const loader = document.createElement('span');\n        loader.classList.add(\"loader\");\n        container.append(loader);\n    } else {\n        const loader = document.querySelector('.loader');\n        if (loader) {\n            loader.remove();\n        }\n    }\n}\n\n\n\nconst toggleButton = (shouldShow) => {\n    btnLoad.style.display = shouldShow ? \"block\" : \"none\";\n    \n}\n\n const lightbox = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionType: 'attr',\n        captionData: 'alt',\n        captionPosition: 'bottom',\n        fadeSpeed: 150,\n        captionSelector: 'img',\n        captionDelay: 250\n    });\n\nlet page = 1;\nlet per_page = 15;\nlet query = \"\";\nlet totalHits;\n\nform.addEventListener(\"submit\", async (evt) => {\n    page = 1;\n    toggleLoader(true);\n    gallery.innerHTML = \"\";\n    evt.preventDefault();\n    try {\n        query = searchInput.value;\n        const photos = await searchImages();\n        renderImages(photos);\n        form.reset();\n        toggleLoader(false);\n        toggleButton(true);\n        if (photos.hits.length < 15) {\n            toggleButton(false);\n        }\n        if (photos.hits.length === 0) {\n            toggleButton(false);\n            iziToast.error({\n                message: \"Sorry, there are no images matching <br>your search query. Please try again!</br>\",\n                position: 'center',\n                transitionIn: \"fadeInLeft\",\n            });\n        }\n\n    } catch (err) {\n        iziToast.err({\n            title: 'Error',\n        });\n    }\n})\n\n\nbtnLoad.addEventListener(\"click\", async () => {\n   toggleLoader(true);\n    try {\n        page += 1;\n        const photos = await searchImages();\n        renderImages(photos);\n        toggleLoader(false);\n\n        const { height: cardHeight } = document.querySelector('.gallery')\n            .firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        });\n        if (gallery.children.length >= totalHits || photos.hits.length < per_page) {\n            iziToast.warning({\n                message: 'We are sorry, but you have reached the end of search results.',\n                position: 'bottomCenter',\n                transitionIn: 'fadeInDown',\n            });\n            toggleButton(false);\n        }\n    } catch (err) {\n        iziToast.err({\n            title: 'Error'\n        })\n        toggleLoader(false);\n    }\n}) \n\nasync function searchImages() {\n    try {\n        const apiKey = '42291440-1a96f303b7bedbf570d96cd98';\n        const params = new URLSearchParams({\n            key: apiKey,\n            q: query,\n            image_type: \"photo\",\n            safesearch: true,\n            page: page,\n            per_page: per_page\n        })\n        const response = await axios.get(`https://pixabay.com/api/?${params}`);\n        totalHits = response.data.totalHits;\n\n        return response.data;\n    } catch (err) {\n        iziToast.error({\n            title: 'Sorry, I can`t find your images'\n        })\n    }\n};\n\nfunction renderImages(data) {\n    const markup = data.hits.map(data => {\n        return `       <li class=\"gallery-item\"><a href=\"${data.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"></a>\n           <p><b>Likes: </b>${data.likes}</p>\n          <p><b>Views: </b>${data.views}</p>\n        <p><b>Comments: </b>${data.comments}</p>\n        <p><b>Downloads: </b>${data.downloads}</p>\n         </li>`;\n    }).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n   \n    lightbox.on('show.simplelightbox').refresh();\n    toggleLoader(false);\n};\n\n\n        \n"],"names":["form","gallery","container","searchInput","btnLoad","toggleLoader","showLoader","loader","toggleButton","shouldShow","lightbox","SimpleLightbox","page","per_page","query","totalHits","evt","photos","searchImages","renderImages","iziToast","cardHeight","apiKey","params","response","axios","data","markup"],"mappings":"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"}